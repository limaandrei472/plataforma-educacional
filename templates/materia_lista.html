{% extends 'base.html' %}

{% block content %}

    <div style="background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); margin-bottom: 30px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap;">
        <div>
            <h1 style="margin: 0; color: #2c3e50;">
                {% if materia.icone %}{{ materia.icone }}{% endif %} 
                {{ materia.nome }}
            </h1>
            <p style="color: #7f8c8d; margin-top: 5px;">Lista de conteÃºdos disponÃ­veis</p>
        </div>

        <form method="GET" style="display: flex; gap: 10px;">
            <input type="text" name="busca" placeholder="Pesquisar assunto..." value="{{ request.GET.busca }}" 
                   style="padding: 10px; border: 1px solid #ccc; border-radius: 5px; width: 250px;">
            <button type="submit" style="padding: 10px 20px; background-color: #3498db; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">
                Buscar
            </button>
            
            {% if request.GET.busca %}
                <a href="{% url 'materia_lista' materia.id %}" style="padding: 10px; color: #e74c3c; text-decoration: none; display: flex; align-items: center;">âœ–</a>
            {% endif %}
        </form>
    </div>

    <div style="display: flex; flex-direction: column; gap: 15px;">

        {% for assunto in assuntos %}
            <div style="background: white; padding: 25px; border-radius: 8px; border-left: 5px solid #3498db; box-shadow: 0 2px 5px rgba(0,0,0,0.05); transition: transform 0.2s;">
                
                <div style="display: flex; justify-content: space-between; align-items: start;">
                    <div>
                        <h2 style="margin: 0 0 10px 0;">
                            <a href="{% url 'aula_detalhe' assunto.id %}" style="text-decoration: none; color: #2c3e50;">
                                {{ assunto.titulo }}
                            </a>
                        </h2>
                        
                        <p style="margin: 0; font-size: 14px; color: #7f8c8d;">
                            Criado por: 
                            <a href="{% url 'professor_perfil' assunto.autor.id %}" style="color: #3498db; text-decoration: none; font-weight: bold;">
                                {{ assunto.autor.nome }}
                            </a>
                            | Em: {{ assunto.criado_em|date:"d/m/Y" }}
                        </p>
                    </div>

                    <a href="{% url 'aula_detalhe' assunto.id %}" style="background-color: #2c3e50; color: white; padding: 8px 15px; text-decoration: none; border-radius: 4px; font-size: 14px;">
                        Ler Aula âž”
                    </a>
                </div>

                <p style="color: #555; margin-top: 15px; font-size: 15px;">
                    {{ assunto.conteudo|truncatewords:20 }}
                </p>

            </div>

        {% empty %}
            <div style="text-align: center; padding: 50px; color: #95a5a6;">
                <h2 style="font-size: 40px; margin-bottom: 10px;">ðŸ“­</h2>
                <h3>Nenhuma aula encontrada.</h3>
                <p>Nenhum professor postou conteÃºdo sobre isso ainda.</p>
                {% if request.GET.busca %}
                    <p>Tente buscar por outro termo ou <a href="{% url 'materia_lista' materia.id %}">limpar o filtro</a>.</p>
                {% endif %}
            </div>
        {% endfor %}

    </div>

{% endblock %}